{
  "hash": "5cc7af746fa27bedde71ff895dd59cef",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Logistic Regression for Predictive Modeling\"\ndescription: |\n  This dataset is originally from the National Institute of Diabetes and Digestive and Kidney Diseases. The objective of the dataset is to diagnostically predict whether a patient has diabetes, based on certain diagnostic measurements included in the dataset\ndate: 2024-08-24\ncategories: [Quarto website]\nimage: 2024-08-24-191338.png\ndraft: false\n\nformat: \n  html: \n    toc: true\n    code-fold: true\nexecute:\n  echo: true\n  eval: false\n---\n\n# 1. Introduction\n\nThis project uses a dataset from the National Institute of Diabetes and Digestive and Kidney Diseases to predict whether a patient has diabetes based on diagnostic measurements. The patients are female and of Pima Indian heritage, aged at least 21 years.\n\n# 2. Load Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load necessary libraries\nsuppressWarnings({\n  library(tidyverse)\n  library(caret)\n  library(gridExtra)\n  library(GGally)\n  library(ROCR)\n  library(knitr)\n  library(kableExtra)\n})\n```\n:::\n\n\n# 3. Load and Explore Data\n## 3.1 Load the Dataset\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- read.csv(\"diabetes.csv\")\n\n# Display the first few rows\ndf %>% \n  head() %>% \n  kable(caption = \"First Few Rows of the Diabetes Dataset\") %>%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), \n                full_width = F, \n                position = \"left\")\n```\n:::\n\n\n## 3.2 Summary Statistics\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get summary statistics\nsummary_stats <- summary(df)\nkable(summary_stats, caption = \"Summary Statistics of the Dataset\") %>%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"),\n                full_width = F,\n                position = \"left\")\n```\n:::\n\n\n##3.3 Missing Values\n\n::: {.cell}\n\n```{.r .cell-code}\n# Check for missing values\ncolSums(is.na(df))\n```\n:::\n\n\n\n#4. Exploratory Data Analysis (EDA)\n##4.1 Univariate Analysis\n###4.1.1 Distribution of Outcome Variable\n\n::: {.cell}\n\n```{.r .cell-code}\n# Distribution of the Outcome variable\nggplot(df, aes(x=factor(Outcome))) +\n  geom_bar(fill=\"steelblue\") +\n  labs(x=\"Outcome\", y=\"Count\", title=\"Distribution of Diabetes Outcome\")\n```\n:::\n\n\n\n###4.1.2 Distribution of Continuous Variables\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plot distributions of all continuous variables\ncontinuous_vars <- df %>% select(-Outcome, -Pregnancies)\ncontinuous_plots <- lapply(names(continuous_vars), function(var) {\n  ggplot(df, aes_string(x=var)) +\n    geom_histogram(fill=\"steelblue\", bins=30) +\n    labs(x=var, y=\"Count\", title=paste(\"Distribution of\", var))\n})\n\ngrid.arrange(grobs=continuous_plots, ncol=2)\n```\n:::\n\n\n\n## 4.2 Bivariate Analysis\n### 4.2.1 Correlation Matrix\n\n::: {.cell}\n\n```{.r .cell-code}\n# Correlation matrix\ncorr_matrix <- cor(df %>% select(-Outcome))\nggcorr(corr_matrix, label=TRUE, label_size=3)\n```\n:::\n\n\n\n## 4.2.2 Relationships with Outcome\n\n::: {.cell}\n\n```{.r .cell-code}\n# Scatter plots for continuous variables vs Outcome\nscatter_plots <- lapply(names(continuous_vars), function(var) {\n  ggplot(df, aes_string(x=var, y=\"Outcome\")) +\n    geom_point(alpha=0.5) +\n    labs(x=var, y=\"Outcome\", title=paste(var, \"vs Outcome\"))\n})\n\ngrid.arrange(grobs=scatter_plots, ncol=2)\n```\n:::\n\n\n# 5. Logistic Regression\n\n::: {.cell}\n\n```{.r .cell-code}\n# Standardizing continuous variables\ndf_scaled <- df\ndf_scaled[,-c(1,9)] <- scale(df_scaled[,-c(1,9)])\nhead(df_scaled)\n```\n:::\n\n\n## 5.1.2 Train-Test Split\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create training (80%) and test (20%) sets\nset.seed(123)\ntrainIndex <- createDataPartition(df_scaled$Outcome, p = .8, \n                                  list = FALSE, \n                                  times = 1)\ndfTrain <- df_scaled[ trainIndex,]\ndfTest  <- df_scaled[-trainIndex,]\n```\n:::\n\n\n## 5.2 Model Training\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit logistic regression model\nlogit_model <- glm(Outcome ~ ., data=dfTrain, family=binomial)\n\n# Summary of the model\nsummary(logit_model)\n```\n:::\n\n\n## 5.3 Model Evaluation\n\n::: {.cell}\n\n```{.r .cell-code}\n# Predict on test data\npred_probs <- predict(logit_model, newdata=dfTest, type=\"response\")\npred_classes <- ifelse(pred_probs > 0.5, 1, 0)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Confusion matrix\nconf_matrix <- confusionMatrix(factor(pred_classes), factor(dfTest$Outcome))\nconf_matrix\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# ROC curve and AUC\npred <- prediction(pred_probs, dfTest$Outcome)\nperf <- performance(pred, \"tpr\", \"fpr\")\nauc <- performance(pred, \"auc\")@y.values[[1]]\n\n# Plot ROC curve\nplot(perf, col=\"blue\", lwd=2, main=paste(\"ROC Curve (AUC =\", round(auc, 2), \")\"))\nabline(a=0, b=1, lty=2, col=\"red\")\n```\n:::\n\n\n\n### Steps to Use This Template:\n\n1. **Save the .qmd file**: Copy the content above into a text editor and save it as `diabetes_analysis.qmd`.\n2. **Place the dataset**: Ensure the `diabetes.csv` file is in your working directory.\n3. **Render the Quarto document**: Open the `.qmd` file in an R or Quarto-compatible IDE (such as RStudio) and render it to create the report.\n\nThis template includes loading necessary packages without warnings, performing EDA with visualizations, and running a logistic regression analysis.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}