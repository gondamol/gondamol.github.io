{
  "hash": "20da157c3a4919655dae44c6edb16462",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Logistic Regression for Predictive Modeling\"\ndescription: |\n  This dataset is originally from the National Institute of Diabetes and Digestive and Kidney Diseases. The objective of the dataset is to diagnostically predict whether a patient has diabetes, based on certain diagnostic measurements included in the dataset\ndate: 2024-08-24\ncategories: [Quarto website]\nimage: 2024-08-24-191338.png\ndraft: false\n\nformat: \n  html: \n    toc: true\n    code-fold: true\nexecute:\n  echo: true\n---\n\n\n# 1. Introduction\n\nThis project uses a dataset from the National Institute of Diabetes and Digestive and Kidney Diseases to predict whether a patient has diabetes based on diagnostic measurements. The patients are female and of Pima Indian heritage, aged at least 21 years.\n\n# 2. Load Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load necessary libraries\nsuppressWarnings({\n  library(tidyverse)\n  library(caret)\n  library(gridExtra)\n  library(GGally)\n  library(ROCR)\n  library(knitr)\n  library(kableExtra)\n})\n```\n:::\n\n\n# 3. Load and Explore Data\n## 3.1 Load the Dataset\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- read.csv(\"diabetes.csv\")\n\n# Display the first few rows\ndf %>% \n  head() %>% \n  kable(caption = \"First Few Rows of the Diabetes Dataset\") %>%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"), \n                full_width = F, \n                position = \"left\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed\" style=\"width: auto !important; \">\n<caption>First Few Rows of the Diabetes Dataset</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> Pregnancies </th>\n   <th style=\"text-align:right;\"> Glucose </th>\n   <th style=\"text-align:right;\"> BloodPressure </th>\n   <th style=\"text-align:right;\"> SkinThickness </th>\n   <th style=\"text-align:right;\"> Insulin </th>\n   <th style=\"text-align:right;\"> BMI </th>\n   <th style=\"text-align:right;\"> DiabetesPedigreeFunction </th>\n   <th style=\"text-align:right;\"> Age </th>\n   <th style=\"text-align:right;\"> Outcome </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 148 </td>\n   <td style=\"text-align:right;\"> 72 </td>\n   <td style=\"text-align:right;\"> 35 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 33.6 </td>\n   <td style=\"text-align:right;\"> 0.627 </td>\n   <td style=\"text-align:right;\"> 50 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 85 </td>\n   <td style=\"text-align:right;\"> 66 </td>\n   <td style=\"text-align:right;\"> 29 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 26.6 </td>\n   <td style=\"text-align:right;\"> 0.351 </td>\n   <td style=\"text-align:right;\"> 31 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 183 </td>\n   <td style=\"text-align:right;\"> 64 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 23.3 </td>\n   <td style=\"text-align:right;\"> 0.672 </td>\n   <td style=\"text-align:right;\"> 32 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 89 </td>\n   <td style=\"text-align:right;\"> 66 </td>\n   <td style=\"text-align:right;\"> 23 </td>\n   <td style=\"text-align:right;\"> 94 </td>\n   <td style=\"text-align:right;\"> 28.1 </td>\n   <td style=\"text-align:right;\"> 0.167 </td>\n   <td style=\"text-align:right;\"> 21 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 137 </td>\n   <td style=\"text-align:right;\"> 40 </td>\n   <td style=\"text-align:right;\"> 35 </td>\n   <td style=\"text-align:right;\"> 168 </td>\n   <td style=\"text-align:right;\"> 43.1 </td>\n   <td style=\"text-align:right;\"> 2.288 </td>\n   <td style=\"text-align:right;\"> 33 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 116 </td>\n   <td style=\"text-align:right;\"> 74 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 25.6 </td>\n   <td style=\"text-align:right;\"> 0.201 </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## 3.2 Summary Statistics\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get summary statistics\nsummary_stats <- summary(df)\nkable(summary_stats, caption = \"Summary Statistics of the Dataset\") %>%\n  kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\"),\n                full_width = F,\n                position = \"left\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed\" style=\"width: auto !important; \">\n<caption>Summary Statistics of the Dataset</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">  </th>\n   <th style=\"text-align:left;\"> Pregnancies </th>\n   <th style=\"text-align:left;\"> Glucose </th>\n   <th style=\"text-align:left;\"> BloodPressure </th>\n   <th style=\"text-align:left;\"> SkinThickness </th>\n   <th style=\"text-align:left;\"> Insulin </th>\n   <th style=\"text-align:left;\"> BMI </th>\n   <th style=\"text-align:left;\"> DiabetesPedigreeFunction </th>\n   <th style=\"text-align:left;\"> Age </th>\n   <th style=\"text-align:left;\"> Outcome </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> Min.   : 0.000 </td>\n   <td style=\"text-align:left;\"> Min.   :  0.0 </td>\n   <td style=\"text-align:left;\"> Min.   :  0.00 </td>\n   <td style=\"text-align:left;\"> Min.   : 0.00 </td>\n   <td style=\"text-align:left;\"> Min.   :  0.0 </td>\n   <td style=\"text-align:left;\"> Min.   : 0.00 </td>\n   <td style=\"text-align:left;\"> Min.   :0.0780 </td>\n   <td style=\"text-align:left;\"> Min.   :21.00 </td>\n   <td style=\"text-align:left;\"> Min.   :0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> 1st Qu.: 1.000 </td>\n   <td style=\"text-align:left;\"> 1st Qu.: 99.0 </td>\n   <td style=\"text-align:left;\"> 1st Qu.: 62.00 </td>\n   <td style=\"text-align:left;\"> 1st Qu.: 0.00 </td>\n   <td style=\"text-align:left;\"> 1st Qu.:  0.0 </td>\n   <td style=\"text-align:left;\"> 1st Qu.:27.30 </td>\n   <td style=\"text-align:left;\"> 1st Qu.:0.2437 </td>\n   <td style=\"text-align:left;\"> 1st Qu.:24.00 </td>\n   <td style=\"text-align:left;\"> 1st Qu.:0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> Median : 3.000 </td>\n   <td style=\"text-align:left;\"> Median :117.0 </td>\n   <td style=\"text-align:left;\"> Median : 72.00 </td>\n   <td style=\"text-align:left;\"> Median :23.00 </td>\n   <td style=\"text-align:left;\"> Median : 30.5 </td>\n   <td style=\"text-align:left;\"> Median :32.00 </td>\n   <td style=\"text-align:left;\"> Median :0.3725 </td>\n   <td style=\"text-align:left;\"> Median :29.00 </td>\n   <td style=\"text-align:left;\"> Median :0.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> Mean   : 3.845 </td>\n   <td style=\"text-align:left;\"> Mean   :120.9 </td>\n   <td style=\"text-align:left;\"> Mean   : 69.11 </td>\n   <td style=\"text-align:left;\"> Mean   :20.54 </td>\n   <td style=\"text-align:left;\"> Mean   : 79.8 </td>\n   <td style=\"text-align:left;\"> Mean   :31.99 </td>\n   <td style=\"text-align:left;\"> Mean   :0.4719 </td>\n   <td style=\"text-align:left;\"> Mean   :33.24 </td>\n   <td style=\"text-align:left;\"> Mean   :0.349 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> 3rd Qu.: 6.000 </td>\n   <td style=\"text-align:left;\"> 3rd Qu.:140.2 </td>\n   <td style=\"text-align:left;\"> 3rd Qu.: 80.00 </td>\n   <td style=\"text-align:left;\"> 3rd Qu.:32.00 </td>\n   <td style=\"text-align:left;\"> 3rd Qu.:127.2 </td>\n   <td style=\"text-align:left;\"> 3rd Qu.:36.60 </td>\n   <td style=\"text-align:left;\"> 3rd Qu.:0.6262 </td>\n   <td style=\"text-align:left;\"> 3rd Qu.:41.00 </td>\n   <td style=\"text-align:left;\"> 3rd Qu.:1.000 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:left;\"> Max.   :17.000 </td>\n   <td style=\"text-align:left;\"> Max.   :199.0 </td>\n   <td style=\"text-align:left;\"> Max.   :122.00 </td>\n   <td style=\"text-align:left;\"> Max.   :99.00 </td>\n   <td style=\"text-align:left;\"> Max.   :846.0 </td>\n   <td style=\"text-align:left;\"> Max.   :67.10 </td>\n   <td style=\"text-align:left;\"> Max.   :2.4200 </td>\n   <td style=\"text-align:left;\"> Max.   :81.00 </td>\n   <td style=\"text-align:left;\"> Max.   :1.000 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n##3.3 Missing Values\n\n::: {.cell}\n\n```{.r .cell-code}\n# Check for missing values\ncolSums(is.na(df))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             Pregnancies                  Glucose            BloodPressure \n                       0                        0                        0 \n           SkinThickness                  Insulin                      BMI \n                       0                        0                        0 \nDiabetesPedigreeFunction                      Age                  Outcome \n                       0                        0                        0 \n```\n\n\n:::\n:::\n\n\n\n#4. Exploratory Data Analysis (EDA)\n##4.1 Univariate Analysis\n###4.1.1 Distribution of Outcome Variable\n\n::: {.cell}\n\n```{.r .cell-code}\n# Distribution of the Outcome variable\nggplot(df, aes(x=factor(Outcome))) +\n  geom_bar(fill=\"steelblue\") +\n  labs(x=\"Outcome\", y=\"Count\", title=\"Distribution of Diabetes Outcome\")\n```\n\n::: {.cell-output-display}\n![](diabetes_eda_lr_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n###4.1.2 Distribution of Continuous Variables\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plot distributions of all continuous variables\ncontinuous_vars <- df %>% select(-Outcome, -Pregnancies)\ncontinuous_plots <- lapply(names(continuous_vars), function(var) {\n  ggplot(df, aes_string(x=var)) +\n    geom_histogram(fill=\"steelblue\", bins=30) +\n    labs(x=var, y=\"Count\", title=paste(\"Distribution of\", var))\n})\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: `aes_string()` was deprecated in ggplot2 3.0.0.\nℹ Please use tidy evaluation idioms with `aes()`.\nℹ See also `vignette(\"ggplot2-in-packages\")` for more information.\n```\n\n\n:::\n\n```{.r .cell-code}\ngrid.arrange(grobs=continuous_plots, ncol=2)\n```\n\n::: {.cell-output-display}\n![](diabetes_eda_lr_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n## 4.2 Bivariate Analysis\n### 4.2.1 Correlation Matrix\n\n::: {.cell}\n\n```{.r .cell-code}\n# Correlation matrix\ncorr_matrix <- cor(df %>% select(-Outcome))\nggcorr(corr_matrix, label=TRUE, label_size=3)\n```\n\n::: {.cell-output-display}\n![](diabetes_eda_lr_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n## 4.2.2 Relationships with Outcome\n\n::: {.cell}\n\n```{.r .cell-code}\n# Scatter plots for continuous variables vs Outcome\nscatter_plots <- lapply(names(continuous_vars), function(var) {\n  ggplot(df, aes_string(x=var, y=\"Outcome\")) +\n    geom_point(alpha=0.5) +\n    labs(x=var, y=\"Outcome\", title=paste(var, \"vs Outcome\"))\n})\n\ngrid.arrange(grobs=scatter_plots, ncol=2)\n```\n\n::: {.cell-output-display}\n![](diabetes_eda_lr_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n# 5. Logistic Regression\n\n::: {.cell}\n\n```{.r .cell-code}\n# Standardizing continuous variables\ndf_scaled <- df\ndf_scaled[,-c(1,9)] <- scale(df_scaled[,-c(1,9)])\nhead(df_scaled)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Pregnancies    Glucose BloodPressure SkinThickness    Insulin        BMI\n1           6  0.8477713     0.1495433     0.9066791 -0.6924393  0.2038799\n2           1 -1.1226647    -0.1604412     0.5305558 -0.6924393 -0.6839762\n3           8  1.9424580    -0.2637694    -1.2873733 -0.6924393 -1.1025370\n4           1 -0.9975577    -0.1604412     0.1544326  0.1232213 -0.4937213\n5           0  0.5037269    -1.5037073     0.9066791  0.7653372  1.4088275\n6           5 -0.1530851     0.2528715    -1.2873733 -0.6924393 -0.8108128\n  DiabetesPedigreeFunction         Age Outcome\n1                0.4681869  1.42506672       1\n2               -0.3648230 -0.19054773       0\n3                0.6040037 -0.10551539       1\n4               -0.9201630 -1.04087112       0\n5                5.4813370 -0.02048305       1\n6               -0.8175458 -0.27558007       0\n```\n\n\n:::\n:::\n\n\n## 5.1.2 Train-Test Split\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create training (80%) and test (20%) sets\nset.seed(123)\ntrainIndex <- createDataPartition(df_scaled$Outcome, p = .8, \n                                  list = FALSE, \n                                  times = 1)\ndfTrain <- df_scaled[ trainIndex,]\ndfTest  <- df_scaled[-trainIndex,]\n```\n:::\n\n\n## 5.2 Model Training\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit logistic regression model\nlogit_model <- glm(Outcome ~ ., data=dfTrain, family=binomial)\n\n# Summary of the model\nsummary(logit_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = Outcome ~ ., family = binomial, data = dfTrain)\n\nCoefficients:\n                         Estimate Std. Error z value Pr(>|z|)    \n(Intercept)              -1.31946    0.18002  -7.330 2.31e-13 ***\nPregnancies               0.11852    0.03579   3.311 0.000929 ***\nGlucose                   1.12827    0.13380   8.433  < 2e-16 ***\nBloodPressure            -0.25320    0.11086  -2.284 0.022374 *  \nSkinThickness            -0.01560    0.12010  -0.130 0.896648    \nInsulin                  -0.10500    0.11341  -0.926 0.354533    \nBMI                       0.67938    0.13114   5.180 2.21e-07 ***\nDiabetesPedigreeFunction  0.25926    0.10642   2.436 0.014845 *  \nAge                       0.17927    0.12106   1.481 0.138676    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 797.28  on 614  degrees of freedom\nResidual deviance: 583.64  on 606  degrees of freedom\nAIC: 601.64\n\nNumber of Fisher Scoring iterations: 5\n```\n\n\n:::\n:::\n\n\n## 5.3 Model Evaluation\n\n::: {.cell}\n\n```{.r .cell-code}\n# Predict on test data\npred_probs <- predict(logit_model, newdata=dfTest, type=\"response\")\npred_classes <- ifelse(pred_probs > 0.5, 1, 0)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Confusion matrix\nconf_matrix <- confusionMatrix(factor(pred_classes), factor(dfTest$Outcome))\nconf_matrix\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nConfusion Matrix and Statistics\n\n          Reference\nPrediction  0  1\n         0 91 22\n         1 10 30\n                                          \n               Accuracy : 0.7908          \n                 95% CI : (0.7178, 0.8523)\n    No Information Rate : 0.6601          \n    P-Value [Acc > NIR] : 0.0002786       \n                                          \n                  Kappa : 0.5063          \n                                          \n Mcnemar's Test P-Value : 0.0518299       \n                                          \n            Sensitivity : 0.9010          \n            Specificity : 0.5769          \n         Pos Pred Value : 0.8053          \n         Neg Pred Value : 0.7500          \n             Prevalence : 0.6601          \n         Detection Rate : 0.5948          \n   Detection Prevalence : 0.7386          \n      Balanced Accuracy : 0.7390          \n                                          \n       'Positive' Class : 0               \n                                          \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# ROC curve and AUC\npred <- prediction(pred_probs, dfTest$Outcome)\nperf <- performance(pred, \"tpr\", \"fpr\")\nauc <- performance(pred, \"auc\")@y.values[[1]]\n\n# Plot ROC curve\nplot(perf, col=\"blue\", lwd=2, main=paste(\"ROC Curve (AUC =\", round(auc, 2), \")\"))\nabline(a=0, b=1, lty=2, col=\"red\")\n```\n\n::: {.cell-output-display}\n![](diabetes_eda_lr_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n\n### Steps to Use This Template:\n\n1. **Save the .qmd file**: Copy the content above into a text editor and save it as `diabetes_analysis.qmd`.\n2. **Place the dataset**: Ensure the `diabetes.csv` file is in your working directory.\n3. **Render the Quarto document**: Open the `.qmd` file in an R or Quarto-compatible IDE (such as RStudio) and render it to create the report.\n\nThis template includes loading necessary packages without warnings, performing EDA with visualizations, and running a logistic regression analysis.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
    "supporting": [
      "diabetes_eda_lr_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}