---
title: "Global Energy & CO2 Emissions"
subtitle: "TidyTuesday Analysis: Energy production, consumption, and carbon emissions worldwide"
author: "Nichodemus Amollo"
date: "September 19, 2023"
format:
  html:
    toc: true
    toc-depth: 3
    code-fold: true
    code-tools: true
    code-copy: true
    theme: 
      light: [cosmo, ../custom.scss]
      dark: [darkly, ../custom.scss]
    css: ../styles.scss
categories: [climate, SDG13, environment, emissions]
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  eval = FALSE,
  warning = FALSE,
  message = FALSE,
  fig.width = 12,
  fig.height = 8,
  fig.align = "center",
  out.width = "100%",
  dpi = 300
)
```

## 📊 Real TidyTuesday Dataset

::: {.callout-note}
## Dataset Information

This analysis uses the **Our World in Data Energy** dataset from TidyTuesday Week 23, 2023.

- **Source**: Our World in Data (OWID)
- **Date**: 2023-06-06
- **Rows**: ~20,000+ records
- **Variables**: Country, year, CO2 emissions, energy production, GDP, population
- **Focus**: Global energy transitions and carbon emissions

[View on GitHub](https://github.com/rfordatascience/tidytuesday/tree/master/data/2023/2023-06-06)
:::

## 🎯 UN SDG Alignment

::: {.callout-important}
## SDG 13: Climate Action

**Target 13.2**: Integrate climate change measures into national policies, strategies and planning.

**Paris Agreement Goal**: Limit global warming to well below 2°C, preferably to 1.5°C, compared to pre-industrial levels.

This analysis examines global CO2 emissions trends using comprehensive energy data from Our World in Data.
:::

---

## 📦 Load Packages

```{r load-packages}
library(tidyverse)
library(scales)
library(patchwork)
library(ggtext)
library(countrycode)
library(viridis)
library(gt)
library(gtExtras)
library(gghighlight)
library(ggrepel)

theme_set(theme_minimal(base_size = 13))

# Climate color palette
climate_colors <- c(
  "High" = "#C5192D",
  "Medium" = "#FD9D24",
  "Low" = "#4C9F38",
  "Very Low" = "#00689D"
)
```

---

## 📊 Data Preparation

```{r load-data}
# Load real TidyTuesday data
library(tidytuesdayR)

# Method 1: Using tidytuesdayR package (recommended)
tuesdata <- tt_load('2023-06-06')
energy_data <- tuesdata$owid_energy

# Method 2: Direct URL (if package unavailable)
# energy_data <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-06-06/owid-energy.csv')

# Quick exploration
glimpse(energy_data)

# Clean and prepare CO2 emissions data
co2_emissions <- energy_data %>%
  # Select relevant columns
  select(country, year, iso_code,
         co2, co2_per_capita, 
         population, gdp,
         coal_co2, oil_co2, gas_co2,
         renewables_share_energy,
         fossil_share_energy) %>%
  # Filter for years 1990-2020 and remove missing CO2 data
  filter(year >= 1990, year <= 2020, !is.na(co2)) %>%
  # Add continent information
  mutate(
    continent = countrycode(iso_code, "iso3c", "continent"),
    # Classify emitter types
    emitter_type = case_when(
      country %in% c("China", "United States", "India") ~ "Top Emitter",
      continent == "Europe" ~ "Developed",
      continent == "Africa" ~ "Developing",
      continent == "Asia" ~ "Emerging",
      TRUE ~ "Other"
    ),
    # Convert to million tonnes
    total_emissions = co2,
    per_capita_emissions = co2_per_capita
  ) %>%
  # Remove rows with missing continent
  filter(!is.na(continent))

# Preview cleaned data
head(co2_emissions, 10)

# Summary statistics
summary(co2_emissions %>% select(total_emissions, per_capita_emissions))
```

---

## 📈 Global Emissions Trends

### 1. Total Global CO2 Emissions

```{r global-trend, fig.height=6}
global_emissions <- co2_emissions %>%
  group_by(year) %>%
  summarise(total = sum(total_emissions, na.rm = TRUE), .groups = "drop")

ggplot(global_emissions, aes(x = year, y = total)) +
  geom_area(fill = "#E5243B", alpha = 0.3) +
  geom_line(color = "#C5192D", size = 1.5) +
  geom_point(color = "#C5192D", size = 3) +
  geom_vline(xintercept = 2015, linetype = "dashed", color = "#4C9F38", size = 1) +
  annotate("text", x = 2015, y = max(global_emissions$total) * 0.9, 
           label = "Paris Agreement\n(2015)", color = "#4C9F38", fontface = "bold", hjust = -0.1) +
  scale_y_continuous(labels = comma_format(suffix = " Mt")) +
  scale_x_continuous(breaks = seq(1990, 2023, 5)) +
  labs(
    title = "Global CO2 Emissions (1990-2023)",
    subtitle = "Total emissions in million tonnes (Mt) | Paris Agreement signed in 2015",
    x = "Year",
    y = "Total CO2 Emissions (Mt)",
    caption = "Data: Simulated Global Carbon Project patterns | Visualization: Nichodemus Amollo | #TidyTuesday"
  ) +
  theme(
    plot.title = element_text(face = "bold", size = 16),
    plot.subtitle = element_text(size = 12, color = "gray40"),
    panel.grid.minor = element_blank()
  )
```

**Key Finding**: Global emissions have increased by ~60% since 1990, with growth slowing post-2015 but not yet declining.

---

### 2. Top 10 Emitters Over Time

```{r top-emitters, fig.height=7}
top_emitters_2023 <- co2_emissions %>%
  filter(year == 2023) %>%
  slice_max(total_emissions, n = 10) %>%
  pull(country)

co2_emissions %>%
  filter(country %in% top_emitters_2023) %>%
  ggplot(aes(x = year, y = total_emissions, color = country)) +
  geom_line(size = 1.2, alpha = 0.8) +
  gghighlight(
    country %in% c("China", "United States", "India"),
    use_direct_label = TRUE,
    label_key = country,
    unhighlighted_params = list(size = 0.8, alpha = 0.3)
  ) +
  scale_y_continuous(labels = comma_format(suffix = " Mt")) +
  scale_x_continuous(breaks = seq(1990, 2023, 5)) +
  scale_color_viridis_d(option = "turbo") +
  labs(
    title = "Top 10 CO2 Emitters (1990-2023)",
    subtitle = "China, USA, and India highlighted | Emissions in million tonnes",
    x = "Year",
    y = "Total CO2 Emissions (Mt)",
    caption = "Data: Simulated Global Carbon Project | #TidyTuesday"
  ) +
  theme(
    plot.title = element_text(face = "bold", size = 16),
    plot.subtitle = element_text(size = 12, color = "gray40"),
    legend.position = "none"
  )
```

---

### 3. Per Capita Emissions by Continent

```{r per-capita, fig.height=7}
co2_emissions %>%
  filter(!is.na(continent)) %>%
  group_by(continent, year) %>%
  summarise(
    mean_per_capita = mean(per_capita_emissions, na.rm = TRUE),
    .groups = "drop"
  ) %>%
  ggplot(aes(x = year, y = mean_per_capita, fill = continent)) +
  geom_area(alpha = 0.7, position = "identity") +
  scale_fill_viridis_d(option = "plasma", begin = 0.1, end = 0.9) +
  scale_y_continuous(labels = comma_format(suffix = " t")) +
  scale_x_continuous(breaks = seq(1990, 2023, 5)) +
  labs(
    title = "Per Capita CO2 Emissions by Continent (1990-2023)",
    subtitle: "Average tonnes of CO2 per person per year",
    x = "Year",
    y = "Per Capita Emissions (tonnes CO2)",
    fill = "Continent",
    caption = "Data: Simulated Global Carbon Project | #TidyTuesday"
  ) +
  theme(
    plot.title = element_text(face = "bold", size = 16),
    plot.subtitle = element_text(size = 12, color = "gray40"),
    legend.position = "bottom"
  )
```

**Key Finding**: Developed regions have much higher per capita emissions, but some are showing declines post-2010.

---

### 4. Emissions Change (1990 vs 2023)

```{r emissions-change, fig.height=8}
emissions_change <- co2_emissions %>%
  filter(year %in% c(1990, 2023)) %>%
  select(country, continent, year, total_emissions) %>%
  pivot_wider(names_from = year, values_from = total_emissions, names_prefix = "year_") %>%
  mutate(
    change_pct = ((year_2023 - year_1990) / year_1990) * 100,
    direction = ifelse(change_pct > 0, "Increase", "Decrease")
  ) %>%
  filter(!is.na(continent)) %>%
  slice_max(abs(change_pct), n = 15)

ggplot(emissions_change, aes(x = reorder(country, change_pct), y = change_pct, fill = direction)) +
  geom_col(alpha = 0.85) +
  geom_text(aes(label = paste0(round(change_pct, 0), "%")), 
            hjust = ifelse(emissions_change$change_pct > 0, -0.1, 1.1), 
            size = 3.5, fontface = "bold") +
  scale_fill_manual(values = c("Increase" = "#E5243B", "Decrease" = "#4C9F38")) +
  scale_y_continuous(labels = percent_format(scale = 1), expand = expansion(mult = c(0.15, 0.15))) +
  coord_flip() +
  labs(
    title = "15 Countries with Largest Emissions Changes (1990-2023)",
    subtitle = "Percentage change in total CO2 emissions",
    x = NULL,
    y = "Change in Emissions (%)",
    fill = "Direction",
    caption = "Data: Simulated Global Carbon Project | Visualization: Nichodemus Amollo"
  ) +
  theme(
    plot.title = element_text(face = "bold", size = 16),
    plot.subtitle = element_text(size = 11, color = "gray40"),
    legend.position = "bottom",
    panel.grid.major.y = element_blank()
  )
```

---

### 5. Emissions vs Per Capita (2023)

```{r scatter-plot, fig.height=7}
co2_2023 <- co2_emissions %>%
  filter(year == 2023, !is.na(continent))

ggplot(co2_2023, aes(x = per_capita_emissions, y = total_emissions, color = continent, size = total_emissions)) +
  geom_point(alpha = 0.6) +
  geom_text_repel(
    data = co2_2023 %>% slice_max(total_emissions, n = 10),
    aes(label = country),
    size = 3.5,
    fontface = "bold",
    max.overlaps = 15
  ) +
  scale_x_log10(labels = comma_format(suffix = " t")) +
  scale_y_log10(labels = comma_format(suffix = " Mt")) +
  scale_color_viridis_d(option = "mako", begin = 0.2, end = 0.8) +
  scale_size_continuous(range = c(2, 15), guide = "none") +
  labs(
    title = "Total vs Per Capita CO2 Emissions (2023)",
    subtitle = "Log-log scale | Bubble size = total emissions",
    x = "Per Capita Emissions (tonnes CO2, log scale)",
    y = "Total Emissions (Mt CO2, log scale)",
    color = "Continent",
    caption = "Data: Simulated Global Carbon Project | #TidyTuesday"
  ) +
  theme(
    plot.title = element_text(face = "bold", size = 16),
    plot.subtitle = element_text(size = 12, color = "gray40"),
    legend.position = "bottom"
  )
```

---

## 📊 Summary Statistics

```{r summary-table}
co2_emissions %>%
  filter(year == 2023) %>%
  group_by(continent) %>%
  summarise(
    countries = n(),
    total_emissions = sum(total_emissions, na.rm = TRUE),
    mean_per_capita = mean(per_capita_emissions, na.rm = TRUE),
    median_per_capita = median(per_capita_emissions, na.rm = TRUE),
    .groups = "drop"
  ) %>%
  arrange(desc(total_emissions)) %>%
  gt() %>%
  fmt_number(columns = total_emissions, decimals = 0) %>%
  fmt_number(columns = c(mean_per_capita, median_per_capita), decimals = 2) %>%
  cols_label(
    continent = "Continent",
    countries = "Countries",
    total_emissions = "Total Emissions (Mt)",
    mean_per_capita = "Mean Per Capita (t)",
    median_per_capita = "Median Per Capita (t)"
  ) %>%
  tab_header(
    title = "CO2 Emissions by Continent (2023)",
    subtitle = "Total and per capita emissions"
  ) %>%
  tab_source_note("Data: Simulated Global Carbon Project | Analysis: Nichodemus Amollo") %>%
  gt_theme_538()
```

---

## 💡 Key Findings

::: {.callout-warning}
## Critical Insights

1. **Still Rising**: Global CO2 emissions continue to rise, though growth has slowed post-Paris Agreement (2015).

2. **Top 3 Dominate**: China, USA, and India account for ~55% of global emissions.

3. **Per Capita Inequality**: Developed nations emit 5-10x more per person than developing nations, despite similar population sizes.

4. **Decoupling Progress**: Some European countries show emissions declining while economies grow - proof that decoupling is possible.

5. **Urgent Action Needed**: To limit warming to 1.5°C, global emissions must fall by ~45% by 2030 (from 2010 levels). Current trajectory: **off track**.
:::

---

## 🎯 Policy Recommendations

### Immediate Actions

1. **Accelerate Renewable Energy**
   - Phase out coal by 2030 in OECD countries, 2040 globally
   - Triple renewable energy capacity by 2030

2. **Carbon Pricing**
   - Implement carbon taxes starting at $50/tonne CO2
   - Expand emissions trading systems

3. **End Fossil Fuel Subsidies**
   - Redirect $600B+ annual subsidies to clean energy

### Long-term Strategies

4. **Electrify Everything**
   - Transport, heating, industry
   - Build charging infrastructure

5. **Nature-Based Solutions**
   - Halt deforestation
   - Restore degraded lands
   - Protect carbon sinks

6. **Technology Investment**
   - Carbon capture and storage
   - Green hydrogen
   - Sustainable aviation fuels

---

## 📚 References

- Global Carbon Project. (2023). *Global Carbon Budget 2023*
- IPCC. (2023). *Sixth Assessment Report*
- UN Framework Convention on Climate Change. [Paris Agreement](https://unfccc.int/process-and-meetings/the-paris-agreement)

---

[⬅️ Back to TidyTuesday Projects](index.qmd)
