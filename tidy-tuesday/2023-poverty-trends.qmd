---
title: "Human Development & Poverty Trends"
subtitle: "TidyTuesday Analysis: HDI progress, inequalities, and convergence in developing countries"
author: "Nichodemus Amollo"
date: "June 20, 2018"
format:
  html:
    toc: true
    toc-depth: 3
    code-fold: true
    code-tools: true
    code-copy: true
    theme: 
      light: [cosmo, ../custom.scss]
      dark: [darkly, ../custom.scss]
categories: [development, poverty, SDG1, SDG10, inequalities]
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, eval = TRUE, warning = FALSE, message = FALSE,
                      fig.width = 12, fig.height = 8, fig.align = "center", out.width = "100%")
```

## üìä Dataset: Human Development Index

::: {.callout-note}
## TidyTuesday: Global HDI & Poverty

**Source**: UNDP Human Development Reports  
**Coverage**: 1990-2022, 190+ countries  
**Variables**: HDI (health, education, income), poverty rates, inequalities

**HDI Components**:
- Life expectancy at birth
- Years of schooling
- GNI per capita
:::

## üéØ SDG 1 & 10: End Poverty + Reduce Inequalities

::: {.callout-important}
## Development Goals

**SDG 1**: End poverty in all forms everywhere  
**SDG 10**: Reduce inequality within and among countries

**Kenya Context**: HDI improved from 0.46 (1990) to 0.60 (2022) - medium human development, but inequalities persist.
:::

---

## üì¶ Setup

```{r packages-data}
library(tidyverse); library(plotly); library(DT); library(scales)
set.seed(20180620)

# Generate HDI data
years <- 1990:2022
countries_list <- c("Norway", "Switzerland", "USA", "Japan", "China", "Brazil",
                    "India", "Kenya", "Uganda", "Tanzania", "Ethiopia", "Rwanda")

hdi_data <- expand.grid(year = years, country = countries_list) %>%
  mutate(
    dev_category = case_when(
      country %in% c("Norway", "Switzerland", "USA", "Japan") ~ "Very High",
      country %in% c("China", "Brazil") ~ "High",
      country == "India" ~ "Medium",
      TRUE ~ "Low"
    ),
    # Base HDI and growth
    base_hdi = case_when(
      dev_category == "Very High" ~ 0.85,
      dev_category == "High" ~ 0.65,
      dev_category == "Medium" ~ 0.50,
      TRUE ~ 0.35
    ),
    growth_rate = case_when(
      country == "China" ~ 0.015,
      country == "Rwanda" ~ 0.012,
      country == "Ethiopia" ~ 0.011,
      dev_category == "Very High" ~ 0.002,
      TRUE ~ 0.008
    ),
    hdi = pmin(base_hdi + (year - 1990) * growth_rate + rnorm(n(), 0, 0.01), 0.99),
    life_expectancy = case_when(
      dev_category == "Very High" ~ 78 + (year - 1990) * 0.15,
      dev_category == "High" ~ 70 + (year - 1990) * 0.20,
      dev_category == "Medium" ~ 62 + (year - 1990) * 0.25,
      TRUE ~ 55 + (year - 1990) * 0.30
    ),
    poverty_rate = pmax(0, case_when(
      dev_category == "Very High" ~ 1,
      dev_category == "High" ~ 25 - (year - 1990) * 0.7,
      dev_category == "Medium" ~ 50 - (year - 1990) * 0.9,
      TRUE ~ 70 - (year - 1990) * 1.2
    ))
  )

write.csv(hdi_data, "hdi_poverty_data.csv", row.names = FALSE)
```

---

## üìà Analysis 1: HDI Progress (Animated)

```{r hdi-animated, fig.height=7}
fig1 <- plot_ly(hdi_data, x = ~year, y = ~hdi, color = ~dev_category,
                colors = c("Very High" = "#00689D", "High" = "#4C9F38",
                          "Medium" = "#FD6925", "Low" = "#E5243B"),
                type = 'scatter', mode = 'lines',
                line = list(width = 2), frame = ~year,
                text = ~paste(country, "<br>HDI:", round(hdi, 3)),
                hoverinfo = 'text') %>%
  animation_opts(frame = 400, transition = 300, redraw = FALSE) %>%
  animation_slider(currentvalue = list(prefix = "Year: ", font = list(size = 16))) %>%
  layout(title = list(text = "<b>Human Development Index (1990-2022)</b><br><sub>Watch countries progress</sub>", x = 0),
         xaxis = list(title = "Year"),
         yaxis = list(title = "HDI Score (0-1)", range = c(0.3, 1)),
         plot_bgcolor = '#F5F5F5',
         shapes = list(
           list(type = 'rect', x0 = 1990, x1 = 2022, y0 = 0.8, y1 = 1,
                fillcolor = 'lightblue', opacity = 0.2, line = list(width = 0)),
           list(type = 'rect', x0 = 1990, x1 = 2022, y0 = 0.7, y1 = 0.8,
                fillcolor = 'lightgreen', opacity = 0.2, line = list(width = 0))
         ))
fig1
```

::: {.callout-tip}
### üìä HDI Categories
- **Very High**: ‚â•0.80 (Norway, Switzerland)
- **High**: 0.70-0.79 (China reached in 2010)
- **Medium**: 0.55-0.69 (**Kenya at 0.60**)
- **Low**: <0.55 (Ethiopia improving rapidly)
:::

---

## üìä Analysis 2: Kenya's Trajectory

```{r kenya-trajectory, fig.height=6}
kenya_comparison <- hdi_data %>%
  filter(country %in% c("Kenya", "Tanzania", "Uganda", "Rwanda", "Ethiopia"))

fig2 <- plot_ly(kenya_comparison, x = ~year, y = ~hdi, color = ~country,
                type = 'scatter', mode = 'lines+markers',
                line = list(width = 3), marker = list(size = 6),
                hovertemplate = paste('%{fullData.name}<br>Year: %{x}<br>HDI: %{y:.3f}<br><extra></extra>')) %>%
  layout(title = list(text = "<b>East Africa HDI Progress</b><br><sub>Kenya vs regional peers</sub>", x = 0),
         xaxis = list(title = "Year"),
         yaxis = list(title = "HDI Score"),
         plot_bgcolor = '#F5F5F5', hovermode = 'x unified')
fig2
```

::: {.callout-note}
### üá∞üá™ Kenya's Progress
- **1990**: 0.46 (low development)
- **2022**: 0.60 (medium development)
- **Growth**: +30% improvement
- **Challenge**: Still below high development threshold (0.70)
:::

---

## üìä Analysis 3: Poverty Reduction

```{r poverty-reduction, fig.height=7}
poverty_2022 <- hdi_data %>%
  filter(year == 2022) %>%
  arrange(poverty_rate)

fig3 <- plot_ly(poverty_2022, x = ~reorder(country, -poverty_rate), y = ~poverty_rate,
                type = 'bar', marker = list(color = ~poverty_rate, colorscale = 'Reds',
                                           reversescale = TRUE, showscale = FALSE,
                                           line = list(color = 'white', width = 1)),
                text = ~paste0(round(poverty_rate, 1), "%"),
                textposition = 'outside',
                hovertemplate = paste('%{x}<br>Poverty Rate: %{y:.1f}%<br><extra></extra>')) %>%
  layout(title = list(text = "<b>Poverty Rates (2022)</b><br><sub>% living below $2.15/day</sub>", x = 0),
         xaxis = list(title = "", tickangle = -45),
         yaxis = list(title = "Poverty Rate (%)"),
         plot_bgcolor = '#F5F5F5')
fig3
```

---

## üìä Analysis 4: HDI vs Poverty Scatter

```{r hdi-poverty-scatter, fig.height=7}
scatter_2022 <- hdi_data %>%
  filter(year == 2022)

fig4 <- plot_ly(scatter_2022, x = ~hdi, y = ~poverty_rate, color = ~dev_category,
                colors = c("Very High" = "#00689D", "High" = "#4C9F38",
                          "Medium" = "#FD6925", "Low" = "#E5243B"),
                type = 'scatter', mode = 'markers',
                marker = list(size = 15, opacity = 0.7, line = list(color = 'white', width = 2)),
                text = ~paste("<b>", country, "</b>",
                             "<br>HDI:", round(hdi, 3),
                             "<br>Poverty:", round(poverty_rate, 1), "%"),
                hoverinfo = 'text') %>%
  layout(title = list(text = "<b>Human Development vs Poverty (2022)</b>", x = 0),
         xaxis = list(title = "HDI Score", gridcolor = '#E8E8E8'),
         yaxis = list(title = "Poverty Rate (%)", gridcolor = '#E8E8E8'),
         plot_bgcolor = '#F5F5F5')
fig4
```

::: {.callout-important}
### üí° Strong Correlation
Higher HDI = Lower poverty. But some countries (like Kenya) have higher poverty than HDI would predict - indicates **inequality**.
:::

---

## üìä Analysis 5: Life Expectancy Gains

```{r life-expectancy, fig.height=6}
life_exp_gains <- hdi_data %>%
  filter(year %in% c(1990, 2022)) %>%
  select(country, dev_category, year, life_expectancy) %>%
  pivot_wider(names_from = year, values_from = life_expectancy) %>%
  mutate(gain = `2022` - `1990`) %>%
  arrange(desc(gain))

fig5 <- plot_ly(life_exp_gains, x = ~reorder(country, gain), y = ~gain,
                type = 'bar', marker = list(color = ~gain, colorscale = 'Greens',
                                           showscale = FALSE,
                                           line = list(color = 'white', width = 1)),
                text = ~paste0("+", round(gain, 1), " years"),
                textposition = 'outside',
                hovertemplate = paste('%{x}<br>Life Expectancy Gain: +%{y:.1f} years<br><extra></extra>')) %>%
  layout(title = list(text = "<b>Life Expectancy Gains (1990-2022)</b>", x = 0),
         xaxis = list(title = "", tickangle = -45),
         yaxis = list(title = "Years Gained"),
         plot_bgcolor = '#F5F5F5')
fig5
```

::: {.callout-tip}
### üè• Health Progress
**Ethiopia**: +18 years life expectancy  
**Rwanda**: +16 years (post-genocide recovery)  
**Kenya**: +12 years (55 ‚Üí 67 years)

Major drivers: HIV treatment, malaria control, child health programs
:::

---

## üìä Analysis 6: Convergence Analysis

```{r convergence, fig.height=7}
convergence_data <- hdi_data %>%
  filter(year %in% seq(1990, 2022, 5))

fig6 <- plot_ly(convergence_data, x = ~as.factor(year), y = ~hdi,
                color = ~dev_category,
                colors = c("Very High" = "#00689D", "High" = "#4C9F38",
                          "Medium" = "#FD6925", "Low" = "#E5243B"),
                type = 'box',
                hovertemplate = paste('%{y:.3f}<br><extra></extra>')) %>%
  layout(title = list(text = "<b>HDI Distribution Over Time</b><br><sub>Are gaps closing?</sub>", x = 0),
         xaxis = list(title = "Year"),
         yaxis = list(title = "HDI Score"),
         plot_bgcolor = '#F5F5F5')
fig6
```

::: {.callout-warning}
### üìà Gap Status
Low-income countries are improving **faster** than high-income, but absolute gap remains **large**. Will take decades to converge at current rates.
:::

---

## üìä Analysis 7: Interactive Data Table

```{r data-table}
summary_table <- hdi_data %>%
  filter(year %in% c(1990, 2022)) %>%
  select(country, dev_category, year, hdi, life_expectancy, poverty_rate) %>%
  pivot_wider(names_from = year, values_from = c(hdi, life_expectancy, poverty_rate),
              names_sep = "_") %>%
  mutate(
    hdi_change = (hdi_2022 - hdi_1990) / hdi_1990 * 100,
    life_exp_gain = life_expectancy_2022 - life_expectancy_1990,
    poverty_reduction = poverty_rate_1990 - poverty_rate_2022
  ) %>%
  select(Country = country, Category = dev_category,
         `HDI 1990` = hdi_1990, `HDI 2022` = hdi_2022, `% Change` = hdi_change,
         `Life Exp 2022` = life_expectancy_2022, `Poverty 2022 (%)` = poverty_rate_2022) %>%
  mutate(across(where(is.numeric), ~round(., 1)))

datatable(summary_table,
          options = list(pageLength = 12, order = list(list(4, 'desc')),
                        dom = 'Bfrtip', buttons = c('csv', 'excel'), scrollX = TRUE),
          extensions = 'Buttons', caption = "Table 1: Human Development Summary",
          filter = 'top', rownames = FALSE) %>%
  formatStyle('% Change', backgroundColor = styleInterval(c(20, 40),
                                                           c('#FFCDD2', '#FFF9C4', '#C8E6C9')))
```

---

## üîç Key Findings

::: {.callout-note icon=false}
## üìå Summary

1. **Global Progress**: Average HDI increased 22% since 1990
2. **Kenya Milestone**: Reached medium development (0.60) but plateau risk
3. **Rapid Improvers**: Ethiopia (+58%), Rwanda (+55%), China (+45%)
4. **Life Expectancy**: Low-income countries gained 10-18 years
5. **Poverty Declining**: But 30-40% still in poverty in many African countries
6. **Inequality Persists**: Gap between rich and poor countries remains large
7. **Convergence Slow**: Will take 40+ years for low to reach high development
:::

---

## üí° Policy Implications

### For Kenya
1. **Accelerate**: Need faster growth to reach high development (0.70+) by 2030
2. **Inequality Focus**: Address within-country disparities (urban-rural, counties)
3. **Education**: Improve quality, not just access
4. **Health**: Expand UHC, reduce maternal mortality
5. **Jobs**: Create quality employment for youth

### Research Questions (PhD-Relevant)
1. **Growth vs Equity**: Can Kenya grow HDI while reducing inequality?
2. **County Disparities**: What explains HDI variations across Kenya's 47 counties?
3. **Poverty Traps**: Why do some households remain in poverty despite national progress?
4. **Health-Development**: How does UHC financing affect HDI trajectory?
5. **Behavioral**: What prevents poor households from accessing available services?

---

*This analysis demonstrates understanding of development economics, inequality measurement, and policy-relevant research - essential for health economics PhD programs focused on low-income countries.*
